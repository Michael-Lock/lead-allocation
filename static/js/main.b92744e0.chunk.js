(this["webpackJsonplead-allocation"]=this["webpackJsonplead-allocation"]||[]).push([[0],{34:function(e,t,n){},37:function(e,t){},39:function(e,t){},53:function(e,t,n){"use strict";n.r(t);var r=n(2),o=n.n(r),i=n(22),a=n.n(i),c=(n(34),n(1)),l=n(9),s=n(23),d=n(24),u=n(29),h=n(28),v=n(25),p=n(0),j=o.a.createRef(),b=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(s.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).handleOpenDialog=function(e){j.current&&j.current.open(e)},e.handleOnFileLoad=function(t){return e.props.onFileLoad(t)},e.handleOnError=function(e,t,n,r){console.log(e)},e.handleOnRemoveFile=function(t){return e.props.OnFileRemove()},e.handleRemoveFile=function(e){j.current&&j.current.removeFile(e)},e}return Object(d.a)(n,[{key:"render",value:function(){var e=this;return Object(p.jsx)(v.a,{ref:j,onFileLoad:this.handleOnFileLoad,onError:this.handleOnError,noClick:!0,noDrag:!0,config:{header:!0,dynamicTyping:!0,skipEmptyLines:!0},onRemoveFile:this.handleOnRemoveFile,children:function(t){var n=t.file;return Object(p.jsxs)("aside",{style:{display:"flex",flexDirection:"row",marginBottom:10},children:[Object(p.jsx)("button",{type:"button",onClick:e.handleOpenDialog,style:{borderRadius:0,marginLeft:0,marginRight:0,width:"40%",paddingLeft:0,paddingRight:0},children:"Browse file"}),Object(p.jsx)("div",{style:{borderWidth:1,borderStyle:"solid",borderColor:"#ccc",height:45,lineHeight:2.5,marginTop:5,marginBottom:5,paddingLeft:13,paddingTop:3,width:"60%"},children:n&&n.name}),Object(p.jsx)("button",{style:{borderRadius:0,marginLeft:0,marginRight:0,paddingLeft:20,paddingRight:20},onClick:e.handleRemoveFile,children:"Remove"})]})}})}}]),n}(r.Component),f=[{id:0,name:"Round Robin",description:"Allocates leads one by one to each available CA",allocationFunction:function(e,t){for(var n=e.slice(),r=t.slice(),o=0,i=0;i<e.length;i++)n[i].allocatedCa=r[o].id,r[o].currentAllotment++,o=(o+1)%t.length;return{leads:n,courseAdvisors:r}}},{id:1,name:"Most Suitable (Aggressive)",description:"Allocates leads always to the CA with the highest likelihood of conversion. Lowest current allotment is used only as a tiebreaker",allocationFunction:function(e,t){for(var n=e.slice(),r=t.slice(),o=0;o<e.length;o++){for(var i=-1,a=void 0,c=0;c<e[o].courseAdvisors.length;c++){var l=e[o].courseAdvisors[c];(!a||l.propensity>i||l.propensity===i&&a.currentAllotment>l.currentAllotment)&&(a=l,i=l.propensity)}n[o].allocatedCa=a.id,r[a.id].currentAllotment++}return{leads:n,courseAdvisors:r}}}];var m=function(e){var t=[Object(p.jsx)("option",{value:null,hidden:!0},"unselected")];return t=t.concat(f.map((function(e){return Object(p.jsx)("option",{value:e.id,children:e.name},e.name)}))),Object(p.jsxs)("div",{children:[Object(p.jsx)("select",{onChange:function(t){return e.onModeChange(t.target.value)},children:t}),Object(p.jsx)("div",{children:e.selectedMode?e.selectedMode.description:""})]})},g=n(27);function O(e){var t=e.columns,n=e.data,r=Object(g.useTable)({columns:t,data:n}),o=r.getTableProps,i=r.getTableBodyProps,a=r.headerGroups,l=r.rows,s=r.prepareRow;return Object(p.jsxs)("table",Object(c.a)(Object(c.a)({},o()),{},{children:[Object(p.jsx)("thead",{children:a.map((function(e){return Object(p.jsx)("tr",Object(c.a)(Object(c.a)({},e.getHeaderGroupProps()),{},{children:e.headers.map((function(e){return Object(p.jsx)("th",Object(c.a)(Object(c.a)({},e.getHeaderProps()),{},{children:e.render("Header")}))}))}))}))}),Object(p.jsx)("tbody",Object(c.a)(Object(c.a)({},i()),{},{children:l.map((function(e,t){return s(e),Object(p.jsx)("tr",Object(c.a)(Object(c.a)({},e.getRowProps()),{},{children:e.cells.map((function(e){return Object(p.jsx)("td",Object(c.a)(Object(c.a)({},e.getCellProps()),{},{children:e.render("Cell")}))}))}))}))}))]}))}var y=function(){var e=Object(r.useState)(),t=Object(l.a)(e,2),n=t[0],i=t[1],a=Object(r.useState)(),s=Object(l.a)(a,2),d=s[0],u=s[1],h=Object(r.useState)(),v=Object(l.a)(h,2),j=v[0],g=v[1],y=o.a.useMemo((function(){return[{Header:"CA",accessor:"caName"},{Header:"Allotment",accessor:"currentAllotment"},{Header:"Average Propensity",accessor:function(e){return e?e.averagePropensity.toFixed(2):0}},{Header:"Variance to Inherent",accessor:function(e){return e?e.varianceToInherent.toFixed(2):0}},{Header:"Predicted Conversions",accessor:function(e){return e?e.predictedConversions.toFixed(2):0}}]}),[]),x=["leadId","created","inherent","portfolio"],A=function(){var e=function(e){for(var t=e.courseAdvisors.slice(),n=0;n<e.leads.length;n++){var r=e.leads[n],o=t[r.allocatedCa],i=r.courseAdvisors[o.id].propensity;o.cumulativePropensity=o.cumulativePropensity+i,o.cumulativeInherent=o.cumulativeInherent+r.inherent}for(var a=0;a<t.length;a++){var l=t[a];l.averagePropensity=l.cumulativePropensity/l.currentAllotment,l.varianceToInherent=l.cumulativePropensity-l.cumulativeInherent,l.predictedConversions=l.currentAllotment*l.averagePropensity}var s=Object(c.a)({},e);return s.courseAdvisors=t,s}(j.allocationFunction(n,d));i(e.leads),u(e.courseAdvisors)};return Object(p.jsx)("div",{className:"App",children:Object(p.jsxs)("header",{className:"App-header",children:[Object(p.jsx)("p",{children:"Lead Allocation Simulator"}),Object(p.jsx)(b,{onFileLoad:function(e){return function(e){for(var t=[],n=function(n){for(var r=e[n].data,o={leadId:r.leadId,created:r.created,inherent:r.inherent,portfolio:r.portfolio,courseAdvisors:[]},i=0,a=function(t){if(x.some((function(r){return r===e[n].meta.fields[t]})))return"continue";var a={id:i++,caName:e[n].meta.fields[t],propensity:r[e[n].meta.fields[t]]};o.courseAdvisors.push(a)},c=0;c<e[n].meta.fields.length;c++)a(c);t[n]=o},r=0;r<e.length;r++)n(r);i(t);var o=[];if(t.length>0)for(var a=t[0].courseAdvisors,c=0;c<a.length;c++)o[c]={id:c,caName:a[c].caName,currentAllotment:0,cumulativePropensity:0,cumulativeInherent:0,averagePropensity:0,varianceToInherent:0,predictedConversions:0};u(o)}(e)},onFileRemove:function(){return i(null),void u(null)}}),Object(p.jsx)(m,{selectedMode:j,onModeChange:function(e){return function(e){g(f[e])}(e)}}),Object(p.jsx)("button",{onClick:function(){return A()},disabled:!n||!j,children:"Run Simulation"}),Object(p.jsx)(O,{columns:y,data:d||[]})]})})},x=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,54)).then((function(t){var n=t.getCLS,r=t.getFID,o=t.getFCP,i=t.getLCP,a=t.getTTFB;n(e),r(e),o(e),i(e),a(e)}))};a.a.render(Object(p.jsx)(o.a.StrictMode,{children:Object(p.jsx)(y,{})}),document.getElementById("root")),x()}},[[53,1,2]]]);
//# sourceMappingURL=main.b92744e0.chunk.js.map