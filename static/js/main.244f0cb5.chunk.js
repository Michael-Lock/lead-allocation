(this["webpackJsonplead-allocation"]=this["webpackJsonplead-allocation"]||[]).push([[0],{35:function(e,t,r){},38:function(e,t){},40:function(e,t){},55:function(e,t,r){"use strict";r.r(t);var n=r(2),o=r.n(n),a=r(24),l=r.n(a),i=(r(35),r(1)),s=r(3),c=r(25),d=r(26),u=r(30),p=r(29),m=r(8),h=r(0),y=function(e){Object(u.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).handleOpenDialog=function(e){n.state.buttonRef.current&&n.state.buttonRef.current.open(e)},n.handleOnFileLoad=function(e){return n.props.onFileLoad(e)},n.handleOnError=function(e,t,r,n){console.log(e)},n.handleOnRemoveFile=function(e){return n.props.onFileRemove()},n.handleRemoveFile=function(e){n.state.buttonRef.current&&n.state.buttonRef.current.removeFile(e)},n.state={buttonRef:o.a.createRef()},n}return Object(d.a)(r,[{key:"render",value:function(){var e=this;return Object(h.jsx)(m.b,{ref:this.state.buttonRef?this.state.buttonRef:null,onFileLoad:this.handleOnFileLoad,onError:this.handleOnError,noClick:!0,noDrag:!0,config:{header:!0,dynamicTyping:!0,skipEmptyLines:!0},onRemoveFile:this.handleOnRemoveFile,children:function(t){var r=t.file;return Object(h.jsxs)("aside",{style:{display:"flex",flexDirection:"row",marginBottom:10},children:[Object(h.jsx)("button",{type:"button",onClick:e.handleOpenDialog,disabled:e.props.disabled,style:{borderRadius:0,marginLeft:0,marginRight:0,width:"40%",paddingLeft:0,paddingRight:0},children:"Browse file"}),Object(h.jsx)("div",{style:{borderWidth:1,borderStyle:"solid",borderColor:"#ccc",height:45,lineHeight:2.5,marginTop:5,marginBottom:5,paddingLeft:13,paddingTop:3,width:"60%"},children:r&&r.name}),Object(h.jsx)("button",{style:{borderRadius:0,marginLeft:0,marginRight:0,paddingLeft:20,paddingRight:20},onClick:e.handleRemoveFile,children:"Remove"})]})}})}}]),r}(n.Component),g={RoundRobin:{id:0,name:"Round Robin",description:"Allocates leads one by one to each available CA",allocationFunction:function(e,t){for(var r=e.slice(),n=t.map((function(e){var t=Object(i.a)({},e);return t.lastAllocatedId=-1,t})),o=n.filter((function(e){return e.portfolio===f})),a=n.filter((function(e){return e.portfolio===v})),l=function(e){var t=r[e],l=void 0;t.portfolio===f?l=o.sort((function(e,t){return e.lastAllocatedId-t.lastAllocatedId})):t.portfolio===v&&(l=a.sort((function(e,t){return e.lastAllocatedId-t.lastAllocatedId})));var i=l.filter((function(e){return H(t.created,e.location)})),s=i.length>0?i[0]:l[0];s.lastAllocatedId=t.leadId,j(t,s,n)},s=0;s<e.length;s++)l(s);return{leads:r,courseAdvisors:n}}},RoundRobinUnconstrained:{id:1,name:"Round Robin (Unconstrained)",description:"Allocates leads one by one to each CA, irrespective of portfolio or working hours",allocationFunction:function(e,t){for(var r=e.slice(),n=t.map((function(e){var t=Object(i.a)({},e);return t.lastAllocatedId=-1,t})),o=0;o<e.length;o++){var a=r[o],l=n.slice().sort((function(e,t){return e.lastAllocatedId-t.lastAllocatedId}))[0];l.lastAllocatedId=a.leadId,j(a,l,n)}return{leads:r,courseAdvisors:n}}},MostSuitableUnconstrained:{id:2,name:"Most Suitable (Unconstrained)",description:"Allocates leads always to the CA with the highest likelihood of conversion. Ignores portfolio and working hours constraints",allocationFunction:function(e,t){for(var r=e.slice(),n=t.slice(),o=0;o<e.length;o++){for(var a=r[o],l=n.slice(),s=0;s<l.length;s++){var c=l[s];l[s]=Object(i.a)(Object(i.a)({},c),{},{propensity:a.courseAdvisors[c.id].propensity})}l.sort((function(e,t){return t.propensity-e.propensity}));var d=l[0];j(a,d,n)}return{leads:r,courseAdvisors:n}}},MostSuitableAggressive:{id:3,name:"Most Suitable (Aggressive)",description:"Allocates leads always to the CA with the highest likelihood of conversion. Uses lowest current allotment as a tiebreaker",allocationFunction:function(e,t){for(var r=e.slice(),n=t.slice(),o=function(e){for(var t=r[e],o=n.filter((function(e){return D(e,t)})),a=0;a<o.length;a++){var l=o[a],s=H(t.created,n[l.id].location);o[a]=Object(i.a)(Object(i.a)({},l),{},{propensity:t.courseAdvisors[l.id].propensity,isInWorkingHours:s})}o.sort((function(e,t){return t.isInWorkingHours&&!e.isInWorkingHours?1:e.isInWorkingHours&&!t.isInWorkingHours?-1:t.propensity!==e.propensity?t.propensity-e.propensity:e.totalAllotment-t.totalAllotment}));var c=o[0];j(t,c,n)},a=0;a<e.length;a++)o(a);return{leads:r,courseAdvisors:n}}},MostSuitableFixedAllotmentTolerance:{id:4,name:"Most Suitable (Fixed allotment tolerance)",description:"Allocates leads to the CA with the highest likelihood of conversion, so long as their allotment is not a given number of leads more than any other CA currently available. If all available CAs are outside of this tolerance, picks the one with the fewest leads currently allotted",parameters:{allotmentTolerance:{order:0,label:"Allotment Tolerance"},decayPerDay:{order:1,label:"Lead decay per day"},cycleDecayDurationDays:{order:2,label:"Days per sales cycle"},decayPerCycle:{order:3,label:"Lead decay per sales cycle (%)"}},allocationFunction:function(e,t,r){return A(e,t,r,!1)}},MostSuitableAdvisorAllotmentTolerance:{id:5,name:"Most Suitable (Per-CA allotment tolerance)",description:"Allocates leads to the CA with the highest likelihood of conversion, so long as their allotment is not a given number of leads more than any other CA currently available. If all available CAs are outside of this tolerance, picks the one with the fewest leads currently allotted",parameters:{decayPerDay:{order:0,label:"Lead decay per day"},cycleDecayDurationDays:{order:1,label:"Days per sales cycle"},decayPerCycle:{order:2,label:"Lead decay per sales cycle (%)"}},allocationFunction:function(e,t,r,n){for(var o=e.slice(),a=t.slice(),l=Number(r[g.MostSuitableAdvisorAllotmentTolerance.parameters.decayPerDay.order]),s=Number(r[g.MostSuitableAdvisorAllotmentTolerance.parameters.cycleDecayDurationDays.order]),c=Number(r[g.MostSuitableAdvisorAllotmentTolerance.parameters.decayPerCycle.order])/100,d=e[0].created.clone().startOf("date"),u=d.clone(),p=d.clone(),m=function(t){var r=o[t],n=Number.MAX_SAFE_INTEGER,d=e[t].created.clone().startOf("date");u=P(a,d,p,u,s,c,l);for(var m=a.filter((function(e){return D(e,r)})),h=0;h<m.length;h++){var y=m[h];n=Math.min(y.currentAllotment,n);var g=H(r.created,a[y.id].location);m[h]=Object(i.a)(Object(i.a)({},y),{},{propensity:r.courseAdvisors[y.id].propensity,isInWorkingHours:g})}m.sort((function(e,t){if(t.isInWorkingHours&&!e.isInWorkingHours)return 1;if(e.isInWorkingHours&&!t.isInWorkingHours)return-1;var r=n+e.allotmentLimit,o=n+t.allotmentLimit,a=r-e.currentAllotment,l=o-t.currentAllotment;return t.currentAllotment<o&&e.currentAllotment>=r?1:e.currentAllotment<r&&t.currentAllotment>=o?-1:e.currentAllotment>=r&&t.currentAllotment>=o&&l!==a?l-a:t.propensity!==e.propensity?t.propensity-e.propensity:e.currentAllotment-t.currentAllotment}));var f=m[0];j(r,f,a)},h=0;h<e.length;h++)m(h);return{leads:o,courseAdvisors:a}}},MostSuitableProportionalAllotmentTolerance:{id:6,name:"Most Suitable (Proportional allotment tolerance)",description:"Allocates leads to the CA with the highest likelihood of conversion, so long as their allotment is not a number of leads more than any other CA currently available by a given percentage. If all available CAs are outside of this tolerance, picks the one with the fewest leads currently allotted",parameters:{allotmentTolerance:{order:0,label:"Allotment Tolerance (%)"},decayPerDay:{order:1,label:"Lead decay per day"},cycleDecayDurationDays:{order:2,label:"Days per sales cycle"},decayPerCycle:{order:3,label:"Lead decay per sales cycle (%)"}},allocationFunction:function(e,t,r){return A(e,t,r,!0)}},PropensityAllotmentBalancedLinear:{id:7,name:"Propensity vs. Allotment Balance (Linear)",description:"Allocates leads to the CA based on both their propensity and their current allotment. Higher propensity will increase the preference given to the CA but a higher allotment will decrease it. Weightings are used to control the relative importance of choosing most suitable vs. balancing allotment",parameters:{propensityWeighting:{order:0,label:"Propensity weighting"},allotmentWeighting:{order:1,label:"Allotment weighting"},decayPerDay:{order:2,label:"Lead decay per day"},cycleDecayDurationDays:{order:3,label:"Days per sales cycle"},decayPerCycle:{order:4,label:"Lead decay per sales cycle (%)"}},allocationFunction:function(e,t,r){for(var n=e.slice(),o=t.slice(),a=Number(r[g.PropensityAllotmentBalancedLinear.parameters.propensityWeighting.order]),l=Number(r[g.PropensityAllotmentBalancedLinear.parameters.allotmentWeighting.order]),s=Number(r[g.PropensityAllotmentBalancedLinear.parameters.decayPerDay.order]),c=Number(r[g.PropensityAllotmentBalancedLinear.parameters.cycleDecayDurationDays.order]),d=Number(r[g.PropensityAllotmentBalancedLinear.parameters.decayPerCycle.order])/100,u=e[0].created.clone().startOf("date"),p=u.clone(),m=u.clone(),h=function(t){var r=n[t],u=0,h=0,y=e[t].created.clone().startOf("date");p=P(o,y,m,p,c,d,s);for(var g=o.filter((function(e){return D(e,r)})),f=0;f<g.length;f++){var v=g[f];u+=v.currentAllotment;var b=H(r.created,o[v.id].location),A=r.courseAdvisors[v.id].propensity*a;h=b?h+1:h,g[f]=Object(i.a)(Object(i.a)({},v),{},{propensityScore:A,isInWorkingHours:b})}var O=void 0;O=h>0?u/h:u/g.length,g.sort((function(e,t){if(t.isInWorkingHours&&!e.isInWorkingHours)return 1;if(e.isInWorkingHours&&!t.isInWorkingHours)return-1;var r=e.propensityScore+(O-e.currentAllotment)*l,n=t.propensityScore+(O-t.currentAllotment)*l;return n!==r?n-r:e.currentAllotment-t.currentAllotment}));var I=g[0];j(r,I,o)},y=0;y<e.length;y++)h(y);return{leads:n,courseAdvisors:o}}},PropensityAllotmentBalancedProportional:{id:8,name:"Propensity vs. Allotment Balance (Proportional)",description:"Allocates leads to the CA based on both their propensity and their current allotment. Higher propensity proportionally relative to the average will increase the preference given to the CA but a higher allotment will decrease it. Weightings are used to control the relative importance of choosing most suitable vs. balancing allotment",parameters:{propensityWeighting:{order:0,label:"Propensity weighting"},allotmentWeighting:{order:1,label:"Allotment weighting"},decayPerDay:{order:2,label:"Lead decay per day"},cycleDecayDurationDays:{order:3,label:"Days per sales cycle"},decayPerCycle:{order:4,label:"Lead decay per sales cycle (%)"}},allocationFunction:function(e,t,r){for(var n=e.slice(),o=t.slice(),a=Number(r[g.PropensityAllotmentBalancedProportional.parameters.propensityWeighting.order]),l=Number(r[g.PropensityAllotmentBalancedProportional.parameters.allotmentWeighting.order]),s=Number(r[g.PropensityAllotmentBalancedProportional.parameters.decayPerDay.order]),c=Number(r[g.PropensityAllotmentBalancedProportional.parameters.cycleDecayDurationDays.order]),d=Number(r[g.PropensityAllotmentBalancedProportional.parameters.decayPerCycle.order])/100,u=e[0].created.clone().startOf("date"),p=u.clone(),m=u.clone(),h=function(t){var r=n[t],u=0,h=0,y=0,g=e[t].created.clone().startOf("date");p=P(o,g,m,p,c,d,s);for(var f=o.filter((function(e){return D(e,r)})),v=0;v<f.length;v++){var b=f[v];u+=b.currentAllotment,h+=r.courseAdvisors[b.id].propensity;var A=H(r.created,o[b.id].location);y=A?y+1:y,f[v]=Object(i.a)(Object(i.a)({},b),{},{propensity:r.courseAdvisors[b.id].propensity,isInWorkingHours:A})}var I=void 0,C=void 0;y>0?(I=u/y,C=h/y):(I=u/f.length,C=h/f.length),f.sort((function(e,t){if(t.isInWorkingHours&&!e.isInWorkingHours)return 1;if(e.isInWorkingHours&&!t.isInWorkingHours)return-1;var r=O(e,C,I,a,l),n=O(t,C,I,a,l);return n!==r?n-r:e.currentAllotment-t.currentAllotment}));var k=f[0];j(r,k,o)},y=0;y<e.length;y++)h(y);return{leads:n,courseAdvisors:o}}},PropensityAllotmentBalancedProportionalPerCluster:{id:9,name:"Propensity vs. Allotment Balance (Proportional per Cluster)",description:"Allocates leads to the CA based on both their propensity and their current allotment. Higher propensity proportionally relative to the average will increase the preference given to the CA but a higher allotment of leads from the same cluster will decrease it. Weightings are used to control the relative importance of choosing most suitable vs. balancing allotment",parameters:{propensityWeighting:{order:0,label:"Propensity weighting"},allotmentWeighting:{order:1,label:"Allotment weighting"}},allocationFunction:function(e,t,r){for(var n=e.slice(),o=t.slice(),a=Number(r[g.PropensityAllotmentBalancedProportional.parameters.propensityWeighting.order]),l=Number(r[g.PropensityAllotmentBalancedProportional.parameters.allotmentWeighting.order]),s=t.slice().map((function(e){return Object(i.a)(Object(i.a)({},e),{},{leadsInCluster:[]})})),c=function(e){for(var t=n[e],r=0,c=0,d=0,u=o.filter((function(e){return D(e,t)})),p=0;p<u.length;p++){var m=u[p];c+=t.courseAdvisors[m.id].propensity;var h=H(t.created,o[m.id].location);d=h?d+1:d;var y=s[m.id].leadsInCluster[t.cluster]?s[m.id].leadsInCluster[t.cluster]:0;r+=y,u[p]=Object(i.a)(Object(i.a)({},m),{},{propensity:t.courseAdvisors[m.id].propensity,isInWorkingHours:h,leadsInCluster:y})}var g=void 0,f=void 0;d>0?(g=r/d,f=c/d):(g=r/u.length,f=c/u.length),u.sort((function(e,t){if(t.isInWorkingHours&&!e.isInWorkingHours)return 1;if(e.isInWorkingHours&&!t.isInWorkingHours)return-1;var r=I(e,f,g,a,l),n=I(t,f,g,a,l);return n!==r?n-r:e.currentAllotment-t.currentAllotment}));var v=u[0];j(t,v,o),s[v.id].leadsInCluster[t.cluster]=s[v.id].leadsInCluster[t.cluster]?s[v.id].leadsInCluster[t.cluster]+1:1},d=0;d<e.length;d++)c(d);return{leads:n,courseAdvisors:o}}},PropensityAllotmentDifficultyBalancedProportional:{id:10,name:"Propensity vs. Allotment vs. Difficulty Balance (Proportional)",description:"Allocates leads to the CA based on their propensity, their current allotment, and the proportion of 'difficult' leads they are getting. Higher propensity proportionally relative to the average will increase the preference given to the CA but a higher allotment will decrease it. If the CA has been receiving a higher number of leads that inherently convert at a low likelihood, they will be increasingly preferred to get higher likelihood leadsWeightings are used to control the relative importance of choosing most suitable vs. balancing allotment",parameters:{propensityWeighting:{order:0,label:"Propensity weighting"},allotmentWeighting:{order:1,label:"Allotment weighting"},difficultyWeighting:{order:2,label:"Difficulty weighting"},decayPerDay:{order:3,label:"Lead decay per day"},cycleDecayDurationDays:{order:4,label:"Days per sales cycle"},decayPerCycle:{order:5,label:"Lead decay per sales cycle (%)"}},allocationFunction:function(e,t,r){for(var n=e.slice(),o=t.slice(),a=Number(r[g.PropensityAllotmentDifficultyBalancedProportional.parameters.propensityWeighting.order]),l=Number(r[g.PropensityAllotmentDifficultyBalancedProportional.parameters.allotmentWeighting.order]),s=Number(r[g.PropensityAllotmentDifficultyBalancedProportional.parameters.difficultyWeighting.order]),c=Number(r[g.PropensityAllotmentDifficultyBalancedProportional.parameters.decayPerDay.order]),d=Number(r[g.PropensityAllotmentDifficultyBalancedProportional.parameters.cycleDecayDurationDays.order]),u=Number(r[g.PropensityAllotmentDifficultyBalancedProportional.parameters.decayPerCycle.order])/100,p=e[0].created.clone().startOf("date"),m=p.clone(),h=p.clone(),y=0,f=function(t){var r=n[t],p=0,g=0,f=0,v=e[t].created.clone().startOf("date");y+=r.inherent,m=P(o,v,h,m,d,u,c);for(var b=o.filter((function(e){return D(e,r)})),A=0;A<b.length;A++){var O=b[A];p+=O.currentAllotment,g+=r.courseAdvisors[O.id].propensity;var I=H(r.created,o[O.id].location);f=I?f+1:f,b[A]=Object(i.a)(Object(i.a)({},O),{},{propensity:r.courseAdvisors[O.id].propensity,isInWorkingHours:I})}var k=void 0,W=void 0,x=void 0;f>0?(k=p/f,W=g/f,x=y/f):(k=p/b.length,W=g/b.length,x=y/b.length),b.sort((function(e,t){if(t.isInWorkingHours&&!e.isInWorkingHours)return 1;if(e.isInWorkingHours&&!t.isInWorkingHours)return-1;var r=C(e,W,k,x,a,l,s),n=C(t,W,k,x,a,l,s);return n!==r?n-r:e.currentAllotment-t.currentAllotment}));var L=b[0];j(r,L,o),o[L.id].runningInherent+=r.inherent},v=0;v<e.length;v++)f(v);return{leads:n,courseAdvisors:o}}}},f="Domestic",v="Canada",b={Adelaide:{startHour:9,endHour:17,timezoneOffsetFromAdelaide:0},Canada:{startHour:22.5,endHour:6.5,timezoneOffsetFromAdelaide:13.5}};function A(e,t,r,n){var o=e.slice(),a=t.slice(),l=Number(r[g.MostSuitableFixedAllotmentTolerance.parameters.allotmentTolerance.order]);n&&(l/=100);for(var s=Number(r[g.MostSuitableFixedAllotmentTolerance.parameters.decayPerDay.order]),c=Number(r[g.MostSuitableFixedAllotmentTolerance.parameters.cycleDecayDurationDays.order]),d=Number(r[g.MostSuitableFixedAllotmentTolerance.parameters.decayPerCycle.order])/100,u=e[0].created.clone().startOf("date"),p=u.clone(),m=u.clone(),h=function(t){var r=o[t],u=Number.MAX_SAFE_INTEGER,h=e[t].created.clone().startOf("date");p=P(a,h,m,p,c,d,s);for(var y=a.filter((function(e){return D(e,r)})),g=0;g<y.length;g++){var f=y[g];u=Math.min(f.currentAllotment,u);var v=H(r.created,a[f.id].location);y[g]=Object(i.a)(Object(i.a)({},f),{},{propensity:r.courseAdvisors[f.id].propensity,isInWorkingHours:v})}var b=void 0;b=n?u+u*l:u+l,y.sort((function(e,t){return t.isInWorkingHours&&!e.isInWorkingHours?1:e.isInWorkingHours&&!t.isInWorkingHours?-1:t.currentAllotment<b&&e.currentAllotment>=b?1:e.currentAllotment<b&&t.currentAllotment>=b?-1:e.currentAllotment>=b&&t.currentAllotment>=b&&t.currentAllotment!==e.currentAllotment?e.currentAllotment-t.currentAllotment:t.propensity!==e.propensity?t.propensity-e.propensity:e.currentAllotment-t.currentAllotment}));var A=y[0];j(r,A,a)},y=0;y<e.length;y++)h(y);return{leads:o,courseAdvisors:a}}function j(e,t,r){e.allocatedCa=t.id,e.allotmentAtAllocation=t.currentAllotment+1,e.assessedPropensity=e.courseAdvisors[t.id].assessedPropensity,e.allocatedPropensity=e.courseAdvisors[t.id].propensity,r[t.id].totalAllotment++,r[t.id].currentAllotment++}function P(e,t,r,n,o,a,l){var i=t.diff(r,"days");if(o>0&&i>=o){for(var s=Math.floor(i/o),c=Math.pow(a,s),d=0;d<e.length;d++){var u=e[d];u.currentAllotment=u.currentAllotment*(1-c)}r.add(o*s,"days")}var p=t.diff(n,"days");if(p>0){for(var m=0;m<e.length;m++){var h=e[m],y=p*l*h.decayModifier;h.currentAllotment=Math.max(h.currentAllotment-y,0)}n=t.clone()}return n}function O(e,t,r,n,o){return(t>0?(e.propensity-t)/t*n:0)+(r-e.currentAllotment)*o}function I(e,t,r,n,o){return(t>0?(e.propensity-t)/t*n:0)+(r-e.leadsInCluster)*o}function C(e,t,r,n,o,a,l){return(t>0?(e.propensity-t)/t*o:0)+(r-e.currentAllotment)*a-(n>0?(e.runningInherent-n/n)*l:0)}function D(e,t){return e.portfolio===t.portfolio}function H(e,t){var r=b[t],n=e.hour()+e.minute()/60,o=e.clone().subtract(r.timezoneOffsetFromAdelaide,"hours").day();if(0===o||6===o)return!1;var a=r.endHour,l=n;return r.endHour<=r.startHour&&(a=r.endHour+24,n<r.startHour&&(l+=24)),l>=r.startHour&&l<=a}var k=function(e){var t=[Object(h.jsx)("option",{value:null,hidden:!0},"unselected")];t=t.concat(Object.keys(g).map((function(e){return Object(h.jsx)("option",{value:e,children:g[e].name},g[e].name)})));var r=[];if(e.selectedMode&&e.selectedMode.parameters)for(var n=Object.keys(e.selectedMode.parameters),o=function(t){var o=e.selectedMode.parameters[n[t]];r[t]=Object(h.jsxs)("div",{children:[Object(h.jsx)("label",{htmlFor:n[t],children:o.label}),Object(h.jsx)("input",{name:n[t],type:"number",step:"any",onChange:function(t){return e.onParameterChange(t,o.order)}})]},n[t])},a=0;a<n.length;a++)o(a);return Object(h.jsxs)("div",{children:[Object(h.jsx)("select",{onChange:function(t){return e.onModeChange(t.target.value)},children:t}),Object(h.jsx)("div",{children:e.selectedMode?e.selectedMode.description:""}),r]})},W=r(17),x=r.n(W),L=r(28);function F(e){var t=e.columns,r=e.data,n=Object(L.useTable)({columns:t,data:r}),o=n.getTableProps,a=n.getTableBodyProps,l=n.headerGroups,s=n.rows,c=n.prepareRow;return Object(h.jsxs)("table",Object(i.a)(Object(i.a)({},o()),{},{children:[Object(h.jsx)("thead",{children:l.map((function(e){return Object(h.jsx)("tr",Object(i.a)(Object(i.a)({},e.getHeaderGroupProps()),{},{children:e.headers.map((function(e){return Object(h.jsx)("th",Object(i.a)(Object(i.a)({},e.getHeaderProps()),{},{children:e.render("Header")}))}))}))}))}),Object(h.jsx)("tbody",Object(i.a)(Object(i.a)({},a()),{},{children:s.map((function(e,t){return c(e),Object(h.jsx)("tr",Object(i.a)(Object(i.a)({},e.getRowProps()),{},{children:e.cells.map((function(e){return Object(h.jsx)("td",Object(i.a)(Object(i.a)({},e.getCellProps()),{},{children:e.render("Cell")}))}))}))}))}))]}))}var R={style:"percent",maximumFractionDigits:2};var M=function(e){var t=o.a.useMemo((function(){return[{Header:"CA",accessor:"caName"},{Header:"Portfolio",accessor:"portfolio"},{Header:"Location",accessor:"location"},{Header:"Total Allotment",accessor:"totalAllotment"},{Header:"Final Allotment",accessor:"currentAllotment"},{Header:"Average Propensity",accessor:function(e){return e?e.averagePropensity.toLocaleString(void 0,R):0}},{Header:"Variance to Inherent",accessor:function(e){return e?e.varianceToInherent.toLocaleString(void 0,R):0}},{Header:"Predicted Conversions",accessor:function(e){return e?e.predictedConversions.toFixed(2):0}}]}),[]),r=o.a.useMemo((function(){return[{Header:"Total Leads",accessor:"totalLeads"},{Header:"Average Propensity",accessor:function(e){return e?e.averagePropensity.toLocaleString(void 0,R):0}},{Header:"Average Variance to Inherent",accessor:function(e){return e?e.averageVarianceToInherent.toLocaleString(void 0,R):0}},{Header:"Predicted Conversions",accessor:function(e){return e?e.predictedConversions.toFixed(2):0}}]}),[]);return Object(h.jsxs)("div",{children:[Object(h.jsx)("h3",{children:"Aggregated Results"}),Object(h.jsx)(F,{columns:r,data:e.aggregatedResults?[e.aggregatedResults]:[]}),Object(h.jsx)("h3",{children:"Individual CA Results"}),Object(h.jsx)(F,{columns:t,data:e.courseAdvisors?e.courseAdvisors:[]})]})};var w=function(){var e=Object(n.useState)(),t=Object(s.a)(e,2),r=t[0],o=t[1],a=Object(n.useState)(),l=Object(s.a)(a,2),c=l[0],d=l[1],u=Object(n.useState)(),p=Object(s.a)(u,2),f=p[0],v=p[1],b=Object(n.useState)(),A=Object(s.a)(b,2),j=A[0],P=A[1],O=Object(n.useState)(),I=Object(s.a)(O,2),C=I[0],D=I[1],H=Object(n.useState)(),W=Object(s.a)(H,2),L=W[0],F=W[1],R=Object(n.useState)(),w=Object(s.a)(R,2),S=w[0],T=w[1],N="YYYY-MM-DDTHH:MMZ",B=function(){o(),d(),P(),D(),F()},E=function(e){for(var t=e.courseAdvisors.slice(),r=0;r<e.leads.length;r++){var n=e.leads[r],o=t[n.allocatedCa],a=n.courseAdvisors[o.id].assessedPropensity;o.cumulativePropensity=o.cumulativePropensity+a,o.cumulativeInherent=o.cumulativeInherent+n.inherent}for(var l={totalLeads:0,cumulativePropensity:0,cumulativeInherent:0,averagePropensity:0,averageVarianceToInherent:0,predictedConversions:0},s=0;s<t.length;s++){var c=t[s];c.averagePropensity=c.totalAllotment?c.cumulativePropensity/c.totalAllotment:0,c.varianceToInherent=c.cumulativeInherent?c.cumulativePropensity/c.cumulativeInherent-1:0,c.predictedConversions=c.totalAllotment*c.averagePropensity,l.totalLeads+=c.totalAllotment,l.cumulativePropensity+=c.cumulativePropensity,l.cumulativeInherent+=c.cumulativeInherent,l.predictedConversions+=c.predictedConversions}l.averagePropensity=l.cumulativePropensity/l.totalLeads,l.averageVarianceToInherent=l.cumulativePropensity/l.cumulativeInherent-1;var d=Object(i.a)({},e);return d.courseAdvisors=t,d.aggregatedResults=l,d=Y(d)},Y=function(e){var t=r.slice().map((function(e){var t=Object(i.a)({},e);return t.created=t.created.format(N),t.allocatedCa=c[t.allocatedCa].caName,delete t.courseAdvisors,t})),n=Object(i.a)({},e);n.leadExportData=t;var o=c.slice().map((function(e){return{name:e.caName,id:e.id,portfolio:e.portfolio,location:e.location,totalAllotment:e.totalAllotment,finalAllotment:e.currentAllotment,averagePropensity:e.averagePropensity,varianceToInherent:e.varianceToInherent,predictedConversions:e.predictedConversions,unmodelledPropensityUsed:e.overallPropensity?e.overallPropensity:"-"}}));return o.push({name:"Total",totalAllotment:e.aggregatedResults.totalLeads,averagePropensity:e.aggregatedResults.averagePropensity,varianceToInherent:e.aggregatedResults.averageVarianceToInherent,predictedConversions:e.aggregatedResults.predictedConversions}),n.resultSummaryExportData=o,n},U=function(e){var t="invalid-nodata";return j&&f&&(t=Object.keys(g)[f.id]+"-"+e+"-"+x()().format("YYYYMMDD-HHMMss")),t};return Object(h.jsx)("div",{className:"App",children:Object(h.jsxs)("header",{className:"App-header",children:[Object(h.jsx)("h3",{children:"CA File"}),Object(h.jsx)(y,{onFileLoad:function(e){return function(e){for(var t=[],r=0;r<e.length;r++){var n=e[r].data,o={id:n.id,caName:n.name,portfolio:n.portfolio,location:n.location,decayModifier:n.decayModifier,allotmentLimit:n.allotmentLimit?n.allotmentLimit:0,overallPropensity:n.overallPropensity?n.overallPropensity:0,totalAllotment:0,currentAllotment:0,cumulativePropensity:0,runningInherent:0,cumulativeInherent:0,averagePropensity:0,varianceToInherent:0,predictedConversions:0};t[r]=o}d(t)}(e)},onFileRemove:function(){return B()}}),Object(h.jsx)("h3",{children:"Lead File"}),Object(h.jsx)(y,{onFileLoad:function(e){return function(e){for(var t=[],r=function(r){for(var n=e[r].data,o={leadId:n.leadId,salesforceId:n.Id,created:x()(n.created,N),cluster:n.cluster,inherent:n.inherent,portfolio:n.portfolio,courseAdvisors:[]},a=0,l=function(t){if(c.some((function(n){return n.caName===e[r].meta.fields[t]}))){var l={id:a,caName:e[r].meta.fields[t],propensity:c[a].overallPropensity?c[a].overallPropensity:n[e[r].meta.fields[t]],assessedPropensity:n[e[r].meta.fields[t]]};o.courseAdvisors.push(l),a++}},i=0;i<e[r].meta.fields.length;i++)l(i);t[r]=o},n=0;n<e.length;n++)r(n);o(t)}(e)},onFileRemove:function(){return B()},disabled:!(c&&c.length>0)}),Object(h.jsx)(k,{selectedMode:f,onModeChange:function(e){return function(e){D(),v(g[e])}(e)},onParameterChange:function(e,t){return function(e,t){var r=C?C.slice():[];e.target.value?r[t]=e.target.value:r.splice(t),D(r)}(e,t)}}),Object(h.jsx)("button",{onClick:function(){return function(){var e=E(f.allocationFunction(r,c,C));o(e.leads),d(e.courseAdvisors),P(e.aggregatedResults),F(e.leadExportData),T(e.resultSummaryExportData)}()},disabled:!r||!f||f.parameters&&(!C||C.length<Object.keys(f.parameters).length),children:"Run Simulation"}),Object(h.jsx)(m.a,{data:L,type:"button",filename:U("LeadAllocation"),bom:!1,children:"Export Lead Allocations"}),Object(h.jsx)(m.a,{data:S,type:"button",filename:U("ResultSummary"),bom:!1,children:"Export Result Summary"}),Object(h.jsx)(M,{courseAdvisors:c,aggregatedResults:j})]})})},S=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,56)).then((function(t){var r=t.getCLS,n=t.getFID,o=t.getFCP,a=t.getLCP,l=t.getTTFB;r(e),n(e),o(e),a(e),l(e)}))};l.a.render(Object(h.jsx)(o.a.StrictMode,{children:Object(h.jsx)(w,{})}),document.getElementById("root")),S()}},[[55,1,2]]]);
//# sourceMappingURL=main.244f0cb5.chunk.js.map